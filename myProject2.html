<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blair Ednie - Data Visualization Portfolio</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        header {
            text-align: center;
            padding: 40px 0;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        h1 {
            color: #2c3e50;
            margin: 0;
        }
        .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
            margin-top: 10px;
        }
        main {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        p {
            color: #34495e;
        }
        .tooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px;
            border-radius: 4px;
            pointer-events: none;
        }
        .viz-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .viz-item img {
            width: 100%;
            height: 600px;
            object-fit: contain;
            background-color: #f8f9fa;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        .viz-item h3 {
            color: #2c3e50;
            margin-top: 0;
            font-size: 1.4em;
        }
        .viz-item p {
            color: #666;
            margin-bottom: 0;
        }
        .nav {
            text-align: center;
            margin-bottom: 20px;
        }
        .nav a {
            display: inline-block;
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            transition: background-color 0.3s ease;
            margin: 0 10px;
        }
        .nav a:hover {
            background-color: #2980b9;
        }
    </style>
</head>
<body>
    <nav class="nav">
        <a href="index.html">Home</a>
    </nav>
    <header>
        <h1>Blair Ednie</h1>
        <div class="subtitle">Project 2: D3.js Interactive Web Page</div>
    </header>
    <main>
        <p>Project 2: D3.js Interactive Web Page</p>
      
        <p>These visualizations created with help from Anthropic's Claude 3.5 LLM.</p>
        
        <h2>Australian Average Max Temperature</h2>
        <p>Dataset: <a href="https://www.kaggle.com/datasets/joshmills/australian-average-daily-maximum-tempreature/data">Josh Mills's "Australian Average Daily Maximum Temperature"</a></p>
        <p><label for="station-select">Select a station:</label>
        <select id="station-select"></select></p>
        <div id="line-chart"></div>
        <div id="station-info"></div>
    </main>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Set the dimensions and margins of the graph
        const margin = {top: 20, right: 30, bottom: 50, left: 60};
        const width = 700 - margin.left - margin.right;
        const height = 400 - margin.top - margin.bottom;

        // Create the SVG container
        const svg = d3.select("#line-chart")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        // Create tooltip div
        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

        // Load and process the data
        d3.csv("AustralianAverageMaxTemp.csv", function(d) {
            return {
                lat: +d.latlongelevnameYearTemp.split(',')[0],
                lon: +d.latlongelevnameYearTemp.split(',')[1],
                elev: +d.latlongelevnameYearTemp.split(',')[2],
                name: d.latlongelevnameYearTemp.split(',')[3],
                year: +d.latlongelevnameYearTemp.split(',')[4],
                temp: +d.latlongelevnameYearTemp.split(',')[5]
            };
        }).then(function(data) {
            // Get unique stations for dropdown
            const stations = [...new Set(data.map(d => d.name))];
            
            // Populate dropdown
            d3.select("#station-select")
                .selectAll("option")
                .data(stations)
                .enter()
                .append("option")
                .text(d => d)
                .attr("value", d => d);

            // Function to update the chart
            function updateChart(selectedStation) {
                // Filter data for selected station
                const filteredData = data.filter(d => d.name === selectedStation);

                // Sort data by year
                filteredData.sort((a, b) => a.year - b.year);

                // Set up scales
                const x = d3.scaleLinear()
                    .domain(d3.extent(filteredData, d => d.year))
                    .range([0, width]);

                const y = d3.scaleLinear()
                    .domain([
                        d3.min(filteredData, d => d.temp) - 1,
                        d3.max(filteredData, d => d.temp) + 1
                    ])
                    .range([height, 0]);

                // Remove existing axes
                svg.selectAll(".axis").remove();

                // Add X axis
                svg.append("g")
                    .attr("class", "axis")
                    .attr("transform", `translate(0,${height})`)
                    .call(d3.axisBottom(x).tickFormat(d3.format("d")))
                    .append("text")
                    .attr("fill", "black")
                    .attr("x", width/2)
                    .attr("y", 40)
                    .text("Year");

                // Add Y axis
                svg.append("g")
                    .attr("class", "axis")
                    .call(d3.axisLeft(y))
                    .append("text")
                    .attr("fill", "black")
                    .attr("transform", "rotate(-90)")
                    .attr("y", -40)
                    .attr("x", -height/2)
                    .attr("text-anchor", "middle")
                    .text("Temperature (째C)");

                // Create line generator
                const line = d3.line()
                    .x(d => x(d.year))
                    .y(d => y(d.temp));

                // Update the line
                const path = svg.selectAll(".line")
                    .data([filteredData]);

                // Enter + Update
                path.enter()
                    .append("path")
                    .attr("class", "line")
                    .merge(path)
                    .transition()
                    .duration(1000)
                    .attr("fill", "none")
                    .attr("stroke", "#3498db")
                    .attr("stroke-width", 2)
                    .attr("d", line);

                // Exit
                path.exit().remove();

                // Add dots
                const dots = svg.selectAll(".dot")
                    .data(filteredData);

                // Enter + Update dots
                dots.enter()
                    .append("circle")
                    .attr("class", "dot")
                    .merge(dots)
                    .attr("cx", d => x(d.year))
                    .attr("cy", d => y(d.temp))
                    .attr("r", 3)
                    .attr("fill", "#3498db")
                    .on("mouseover", function(event, d) {
                        tooltip.transition()
                            .duration(200)
                            .style("opacity", .9);
                        tooltip.html(`Year: ${d.year}<br/>Temperature: ${d.temp.toFixed(2)}째C<br/>Location: ${d.name}<br/>Lat: ${d.lat}, Lon: ${d.lon}<br/>Elevation: ${d.elev}m`)
                            .style("left", (event.pageX + 10) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    })
                    .on("mouseout", function(d) {
                        tooltip.transition()
                            .duration(500)
                            .style("opacity", 0);
                    });

                // Exit dots
                dots.exit().remove();

                // Add station info
                const stationInfo = filteredData[0];
                d3.select("#station-info")
                    .html(`<p>Station: ${stationInfo.name}<br>
                          Latitude: ${stationInfo.lat}째<br>
                          Longitude: ${stationInfo.lon}째<br>
                          Elevation: ${stationInfo.elev}m</p>`);
            }

            // Initial chart with first station
            updateChart(stations[0]);

            // Update chart when dropdown selection changes
            d3.select("#station-select").on("change", function() {
                updateChart(this.value);
            });
        }).catch(function(error) {
            console.log(error);
            svg.append("text")
                .attr("x", width/2)
                .attr("y", height/2)
                .attr("text-anchor", "middle")
                .text("Error loading data: Please ensure australian_temp.csv is in the correct location");
        });
    });
    </script>
</body>
</html>
